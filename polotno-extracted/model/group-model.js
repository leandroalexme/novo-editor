var e=this&&this.__rest||function(e,t){var r={};for(var o in e){Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o])}if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(o=Object.getOwnPropertySymbols(e);l<o.length;l++){t.indexOf(o[l])<0&&Object.prototype.propertyIsEnumerable.call(e,o[l])&&(r[o[l]]=e[o[l]])}}return r};Object.defineProperty(exports,"__esModule",{value:!0}),exports.TYPES_MAP=exports.GroupElement=exports.ElementTypes=exports.forEveryChild=void 0,exports.registerShapeModel=function(e,t){const r=e.type;if(!r){throw new Error('You must pass "type" attribute to custom model.')}let o=l.Shape.named(r).props(e);t&&(o=t(o)),exports.TYPES_MAP[r]=o,c.push(o)};const t=require("mobx-state-tree"),r=require("nanoid"),o=require("./node-model"),l=require("./shape-model"),n=require("./text-model"),i=require("./image-model"),s=require("./video-model"),d=require("./line-model"),p=require("./svg-model"),a=require("./figure-model"),E=require("./gif-model");exports.forEveryChild=(e,t)=>{if(e.children){for(const r of e.children){if(!0===t(r)){break}(0,exports.forEveryChild)(r,t)}}};const m=[...new Array(20)].map(((e,r)=>t.types.late((()=>c[r]))));exports.ElementTypes=t.types.union({dispatcher:e=>{const t=exports.TYPES_MAP[e.type];if(!t){throw new Error(`Unknown element type: "${e.type}"`)}return t}},p.SVGElement,n.TextElement,i.ImageElement,d.LineElement,s.VideoElement,a.FigureElement,E.GifElement,t.types.late((()=>exports.GroupElement)),...m),exports.GroupElement=o.Node.named("Group").props({type:"group",children:t.types.array(exports.ElementTypes)}).views((e=>({get draggable(){let t=!0;return(0,exports.forEveryChild)(e,(e=>{e.draggable||(t=!1)})),t},get resizable(){let t=!0;return(0,exports.forEveryChild)(e,(e=>{e.resizable||(t=!1)})),t},get contentEditable(){let t=!0;return(0,exports.forEveryChild)(e,(e=>{e.contentEditable||(t=!1)})),t},get styleEditable(){let t=!0;return(0,exports.forEveryChild)(e,(e=>{e.styleEditable||(t=!1)})),t},get locked(){let t=!0;return(0,exports.forEveryChild)(e,(e=>{e.locked||(t=!1)})),t}}))).actions((o=>({set(t){var{draggable:r,contentEditable:l,styleEditable:n,resizable:i}=t,s=e(t,["draggable","contentEditable","styleEditable","resizable"]);void 0!==r&&(0,exports.forEveryChild)(o,(e=>{e.set({draggable:r})})),void 0!==l&&(0,exports.forEveryChild)(o,(e=>{e.set({contentEditable:l})})),void 0!==n&&(0,exports.forEveryChild)(o,(e=>{e.set({styleEditable:n})})),void 0!==i&&(0,exports.forEveryChild)(o,(e=>{e.set({resizable:i})})),Object.assign(o,s)},addElement(e,{skipSelect:t=!1}={}){const l=exports.TYPES_MAP[e.type];if(!l){return void console.error("Can not find model with type "+e.type)}e.children&&e.children.forEach((e=>{e.id=e.id||(0,r.nanoid)(10)}));const n=l.create(Object.assign({id:(0,r.nanoid)(10)},e));return o.children.push(n),n.selectable&&!t&&o.store.selectElements([n.id]),n},setElementZIndex(e,r){const l=o.children.find((t=>t.id===e));l&&((0,t.detach)(l),o.children.remove(l),o.children.splice(r,0,l))}})));const c=[];exports.TYPES_MAP={svg:p.SVGElement,text:n.TextElement,image:i.ImageElement,group:exports.GroupElement,line:d.LineElement,video:s.VideoElement,figure:a.FigureElement,gif:E.GifElement};