var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ImageRemoveBackground=exports.RemoveBackgroundDialog=void 0,exports.setRemoveBackgroundFunc=function(e){n=e};const t=e(require("react")),a=require("mobx-react-lite"),r=require("@blueprintjs/core"),o=require("../utils/api"),l=require("../utils/l10n");let n=async e=>{const t=await fetch((0,o.removeBackground)(),{method:"POST",body:JSON.stringify({url:e})});return 200!==t.status?(alert((0,l.t)("error.removeBackground")),e):(await t.json()).url};exports.RemoveBackgroundDialog=(0,a.observer)((({isOpen:e,onClose:a,element:o})=>{const[s,c]=t.default.useState(o.src);t.default.useEffect((()=>{c(o.src)}),[o.src]);const[u,i]=t.default.useState(!1),d=s!==o.src;return t.default.createElement(r.Dialog,{onClose:a,title:(0,l.t)("toolbar.removeBackgroundTitle"),isOpen:e,style:{width:"80%",maxWidth:"700px"}},t.default.createElement("div",{className:r.Classes.DIALOG_BODY},t.default.createElement("img",{src:s,style:{width:"100%",maxHeight:"400px",objectFit:"contain"}})),t.default.createElement("div",{className:r.Classes.DIALOG_FOOTER,style:{position:"relative"}},t.default.createElement("div",{className:r.Classes.DIALOG_FOOTER_ACTIONS},!d&&t.default.createElement(r.Button,{onClick:async()=>{i(!0);try{c(await n(o.src))}catch(e){console.error(e)}i(!1)},loading:u},(0,l.t)("toolbar.removeBackground")),d&&t.default.createElement(t.default.Fragment,null,t.default.createElement(r.Button,{onClick:()=>{c(o.src),a()},loading:u},(0,l.t)("toolbar.cancelRemoveBackground")),t.default.createElement(r.Button,{onClick:()=>{o.set({src:s}),a()},loading:u,intent:"primary"},(0,l.t)("toolbar.confirmRemoveBackground"))))))})),exports.ImageRemoveBackground=({element:e})=>{const[a,o]=t.default.useState(!1);return t.default.createElement(t.default.Fragment,null,t.default.createElement(r.Button,{text:(0,l.t)("toolbar.removeBackground"),minimal:!0,onClick:e=>{o(!0)}}),t.default.createElement(exports.RemoveBackgroundDialog,{isOpen:a,onClose:()=>{o(!1)},element:e}))};