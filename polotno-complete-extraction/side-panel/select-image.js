Object.defineProperty(exports,"__esModule",{value:!0}),exports.selectImage=void 0;const e=require("../utils/image"),t=require("../utils/image");exports.selectImage=async({src:i,droppedPos:s,targetElement:n,store:d})=>{var a;if(n&&"svg"===n.type&&n.contentEditable){const e=n.parent,t=n.zIndex,s=Object.assign({},n.toJSON());return delete s.id,d.deleteElements([n.id]),void e.addElement(Object.assign(Object.assign({},s),{type:"image",src:i,clipSrc:s.src})).setZIndex(t)}n&&"figure"===n.type&&n.contentEditable;let{width:r,height:c}=await(0,e.getImageSize)(i);if(n&&"image"===n.type&&n.contentEditable){const e=(0,t.getCrop)(n,{width:r,height:c});return void n.set(Object.assign({src:i},e))}const o=Math.min(d.width/r,d.height/c,1);r*=o,c*=o;const g=((null==s?void 0:s.x)||d.width/2)-r/2,l=((null==s?void 0:s.y)||d.height/2)-c/2;null===(a=d.activePage)||void 0===a||a.addElement({type:"image",src:i,width:r,height:c,x:g,y:l})};