var e=this&&this.__rest||function(e,t){var a={};for(var l in e){Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l])}if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(l=Object.getOwnPropertySymbols(e);n<l.length;n++){t.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(a[l[n]]=e[l[n]])}}return a},t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.EffectsPanel=exports.NumberInput=void 0;const a=t(require("react")),l=require("@blueprintjs/core"),n=require("mobx-react-lite"),r=require("../model/shape-model"),i=t(require("../toolbar/color-picker")),d=require("../utils/l10n"),o=require("@blueprintjs/icons"),u=require("./effect-card"),s=require("../utils/filters"),c=(e,t,a)=>Math.max(t,Math.min(a,e));exports.NumberInput=t=>{var{value:n,onValueChange:r}=t,i=e(t,["value","onValueChange"]);const[d,o]=a.default.useState(n.toString());return a.default.useEffect((()=>{o(n.toString())}),[n]),a.default.createElement(l.NumericInput,Object.assign({value:d,onValueChange:(e,t)=>{o(t),Number.isNaN(e)||r(e)}},i))};const m=({label:e,enabled:t,visible:n=!0,onEnabledChange:r,numberValue:i,onNumberValueChange:d,min:o,max:u})=>n?a.default.createElement(a.default.Fragment,null,a.default.createElement(l.Switch,{checked:t,label:e,onChange:e=>{r(e.target.checked)},alignIndicator:l.Alignment.RIGHT,style:{marginTop:"20px"}}),t&&a.default.createElement("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"}},a.default.createElement("div",{style:{paddingTop:"7px",paddingLeft:"10px",width:"calc(100% - 80px)"}},a.default.createElement(l.Slider,{value:i,onChange:e=>{d(e)},min:o,max:u,labelStepSize:50,showTrackFill:!1,labelRenderer:!1})),a.default.createElement(l.NumericInput,{value:i,onValueChange:e=>{d(c(e,o,u))},buttonPosition:"none",style:{width:"50px",padding:"0 5px",marginLeft:"10px"},min:o,max:u}))):null;exports.EffectsPanel=(0,n.observer)((({store:e})=>{var t,n,f,b,h,p,g,E,v,x,y,C,w,k;const S=e.selectedElements,V=S[0],I=()=>e.selectedElements.map((e=>e.id)).join(","),N=a.default.useMemo(I,[]),O=I();if(a.default.useEffect((()=>{N!==O&&e.openSidePanel(e.previousOpenedSidePanel)}),[N,O]),!V){return null}const M=(e=>"text"===e.type)(V),T=(e=>"image"===e.type)(V),R=(e=>"svg"===e.type)(V),P=T||R,j=t=>{e.history.transaction((()=>{S.forEach((e=>{e.set(t)}))}))},B=(t,a)=>{e.history.transaction((()=>{S.forEach((e=>{let l=+a;return 0==a||a||(l=e.filters.has(t)?null:1),r.INDEPENDENT_FILTERS.includes(t)||e.set({grayscaleEnabled:"grayscale"===t&&a,sepiaEnabled:"sepia"===t&&a}),e.setFilter(t,l)}))}))};return a.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",overflow:"auto",padding:"0 10px"}},a.default.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},a.default.createElement("h3",{style:{margin:0,lineHeight:"30px"}},(0,d.t)("sidePanel.effects")),a.default.createElement(l.Button,{minimal:!0,icon:a.default.createElement(o.Cross,null),onClick:()=>e.openSidePanel(e.previousOpenedSidePanel)})),P&&a.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"16px",marginTop:"16px"}},a.default.createElement("div",{style:{display:"flex",gap:"16px",flexWrap:"wrap"}},a.default.createElement(u.EffectCard,{active:V.grayscaleEnabled,onClick:()=>{B("grayscale",!V.grayscaleEnabled)},title:(0,d.t)("toolbar.grayscale"),imageSrc:V.src,effect:s.Effects.grayscale}),a.default.createElement(u.EffectCard,{active:V.sepiaEnabled,onClick:()=>{B("sepia",!V.sepiaEnabled)},title:(0,d.t)("toolbar.sepia"),imageSrc:V.src,effect:s.Effects.sepia}),a.default.createElement(u.EffectCard,{active:V.filters.has("cold"),onClick:()=>{B("cold",V.filters.has("cold")?null:1)},title:(0,d.t)("toolbar.cold"),imageSrc:V.src,effect:s.Effects.cold}),a.default.createElement(u.EffectCard,{active:V.filters.has("natural"),onClick:()=>{B("natural",V.filters.has("natural")?null:1)},title:(0,d.t)("toolbar.natural"),imageSrc:V.src,effect:s.Effects.natural}),a.default.createElement(u.EffectCard,{active:V.filters.has("warm"),onClick:()=>{B("warm",V.filters.has("warm")?null:1)},title:(0,d.t)("toolbar.warm"),imageSrc:V.src,effect:s.Effects.warm}))),a.default.createElement(m,{label:(0,d.t)("toolbar.blur"),enabled:V.blurEnabled,visible:P||M,onEnabledChange:e=>{j({blurEnabled:e})},numberValue:V.blurRadius,onNumberValueChange:e=>{j({blurRadius:e})},min:0,max:100}),a.default.createElement(m,{label:(0,d.t)("toolbar.brightness"),visible:P,enabled:V.brightnessEnabled,onEnabledChange:e=>{j({brightnessEnabled:e})},numberValue:Math.round(100*V.brightness),onNumberValueChange:e=>{j({brightness:e/100})},min:-100,max:100}),a.default.createElement(m,{label:(0,d.t)("toolbar.temperature"),visible:P,enabled:V.filters.has("temperature"),onEnabledChange:e=>{B("temperature",e?0:null)},numberValue:Math.round(100*(null!==(n=null===(t=V.filters.get("temperature"))||void 0===t?void 0:t.intensity)&&void 0!==n?n:0)),onNumberValueChange:e=>{B("temperature",e/100)},min:-100,max:100}),a.default.createElement(m,{label:(0,d.t)("toolbar.contrast"),visible:P,enabled:V.filters.has("contrast"),onEnabledChange:e=>{B("contrast",e?0:null)},numberValue:Math.round(100*(null!==(b=null===(f=V.filters.get("contrast"))||void 0===f?void 0:f.intensity)&&void 0!==b?b:0)),onNumberValueChange:e=>{B("contrast",e/100)},min:-100,max:100}),a.default.createElement(m,{label:(0,d.t)("toolbar.shadows"),visible:P,enabled:V.filters.has("shadows"),onEnabledChange:e=>{B("shadows",e?0:null)},numberValue:Math.round(100*(null!==(p=null===(h=V.filters.get("shadows"))||void 0===h?void 0:h.intensity)&&void 0!==p?p:0)),onNumberValueChange:e=>{B("shadows",e/100)},min:-100,max:100}),a.default.createElement(m,{label:(0,d.t)("toolbar.white"),visible:P,enabled:V.filters.has("white"),onEnabledChange:e=>{B("white",e?0:null)},numberValue:Math.round(100*(null!==(E=null===(g=V.filters.get("white"))||void 0===g?void 0:g.intensity)&&void 0!==E?E:0)),onNumberValueChange:e=>{B("white",e/100)},min:-100,max:100}),a.default.createElement(m,{label:(0,d.t)("toolbar.black"),visible:P,enabled:V.filters.has("black"),onEnabledChange:e=>{B("black",e?0:null)},numberValue:Math.round(100*(null!==(x=null===(v=V.filters.get("black"))||void 0===v?void 0:v.intensity)&&void 0!==x?x:0)),onNumberValueChange:e=>{B("black",e/100)},min:-100,max:100}),a.default.createElement(m,{label:(0,d.t)("toolbar.vibrance"),visible:P,enabled:V.filters.has("vibrance"),onEnabledChange:e=>{B("vibrance",e?0:null)},numberValue:Math.round(100*(null!==(C=null===(y=V.filters.get("vibrance"))||void 0===y?void 0:y.intensity)&&void 0!==C?C:0)),onNumberValueChange:e=>{B("vibrance",e/100)},min:-100,max:100}),a.default.createElement(m,{label:(0,d.t)("toolbar.saturation"),visible:P,enabled:V.filters.has("saturation"),onEnabledChange:e=>{B("saturation",e?0:null)},numberValue:Math.round(100*(null!==(k=null===(w=V.filters.get("saturation"))||void 0===w?void 0:w.intensity)&&void 0!==k?k:0)),onNumberValueChange:e=>{B("saturation",e/100)},min:-100,max:100}),M&&a.default.createElement(l.Switch,{checked:!!V.strokeWidth,label:(0,d.t)("toolbar.textStroke"),onChange:e=>{j({strokeWidth:e.target.checked?2:0})},alignIndicator:l.Alignment.RIGHT,style:{marginTop:"20px"}}),M&&!!V.strokeWidth&&a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},a.default.createElement(i.default,{value:V.stroke,size:30,onChange:e=>{j({stroke:e})},store:e}),a.default.createElement(l.NumericInput,{defaultValue:V.strokeWidth,onValueChange:e=>{j({strokeWidth:c(e,1,30)})},style:{width:"80px"},min:1,max:Math.round(V.fontSize/2)}))),M&&a.default.createElement(l.Switch,{checked:!!V.backgroundEnabled,label:(0,d.t)("toolbar.textBackground"),onChange:e=>{j({backgroundEnabled:e.target.checked})},alignIndicator:l.Alignment.RIGHT,style:{marginTop:"20px"}}),M&&!!V.backgroundEnabled&&a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},a.default.createElement("div",null,(0,d.t)("toolbar.backgroundCornerRadius")),a.default.createElement("div",null,a.default.createElement(exports.NumberInput,{value:100*V.backgroundCornerRadius,onValueChange:e=>{j({backgroundCornerRadius:c(e,0,100)/100})},style:{width:"50px"},min:0,max:100,buttonPosition:"none"}))),a.default.createElement(l.Slider,{value:100*V.backgroundCornerRadius,onChange:e=>{j({backgroundCornerRadius:c(e,0,100)/100})},min:0,max:100,labelRenderer:!1}),a.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},a.default.createElement("div",null,(0,d.t)("toolbar.backgroundPadding")),a.default.createElement("div",null,a.default.createElement(exports.NumberInput,{value:Math.round(100*V.backgroundPadding),onValueChange:e=>{j({backgroundPadding:c(e,0,100)/100})},style:{width:"50px"},min:0,max:100,buttonPosition:"none"}))),a.default.createElement(l.Slider,{value:Math.round(100*V.backgroundPadding),onChange:e=>{j({backgroundPadding:c(e,0,100)/100})},min:0,max:100,labelRenderer:!1}),a.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},a.default.createElement("div",null,(0,d.t)("toolbar.opacity")),a.default.createElement("div",null,a.default.createElement(exports.NumberInput,{value:Math.round(100*V.backgroundOpacity),onValueChange:e=>{j({backgroundOpacity:e/100})},style:{width:"50px"},min:0,max:100,buttonPosition:"none"}))),a.default.createElement(l.Slider,{value:100*V.backgroundOpacity,onChange:e=>{j({backgroundOpacity:e/100})},min:0,max:100,labelRenderer:!1}),a.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},a.default.createElement("div",{style:{lineHeight:"30px"}},(0,d.t)("toolbar.color")),a.default.createElement(i.default,{value:V.backgroundColor,size:30,onChange:e=>{j({backgroundColor:e})},store:e}))),P&&a.default.createElement(l.Switch,{checked:!!V.borderSize,label:(0,d.t)("toolbar.border"),onChange:e=>{j({borderSize:e.target.checked?2:0})},alignIndicator:l.Alignment.RIGHT,style:{marginTop:"20px"}}),P&&!!V.borderSize&&a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},a.default.createElement(i.default,{value:V.borderColor,size:30,onChange:e=>{j({borderColor:e})},store:e}),a.default.createElement(l.NumericInput,{defaultValue:V.borderSize,onValueChange:e=>{j({borderSize:c(e,1,Math.min(V.width,V.height)/2)})},style:{width:"80px"},min:1,max:Math.max(1,Math.min(V.width,V.height)/2)}))),P&&a.default.createElement(m,{label:(0,d.t)("toolbar.cornerRadius"),visible:P,enabled:0!==V.cornerRadius,onEnabledChange:e=>{j({cornerRadius:e?Math.min(V.width/4,V.height/4):0})},numberValue:Math.min(V.cornerRadius,Math.round(Math.min(V.width/2,V.height/2))),onNumberValueChange:e=>{j({cornerRadius:e})},min:1,max:Math.round(Math.min(V.width/2,V.height/2))}),a.default.createElement(l.Switch,{checked:V.shadowEnabled,label:(0,d.t)("toolbar.shadow"),onChange:e=>{j({shadowEnabled:e.target.checked})},alignIndicator:l.Alignment.RIGHT,style:{marginTop:"20px"}}),V.shadowEnabled&&a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},a.default.createElement("div",null,(0,d.t)("toolbar.blur")),a.default.createElement("div",null,a.default.createElement(exports.NumberInput,{value:V.shadowBlur,onValueChange:e=>{j({shadowBlur:c(e,-50,50)})},style:{width:"50px"},min:0,max:50,buttonPosition:"none"}))),a.default.createElement("div",null,a.default.createElement(l.Slider,{value:V.shadowBlur,onChange:e=>{j({shadowBlur:e})},min:0,max:50,showTrackFill:!1,labelRenderer:!1})),a.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},a.default.createElement("div",null,(0,d.t)("toolbar.offsetX")),a.default.createElement("div",null,a.default.createElement(exports.NumberInput,{value:V.shadowOffsetX,onValueChange:e=>{j({shadowOffsetX:c(e,-50,50)})},style:{width:"50px"},min:-50,max:50,buttonPosition:"none"}))),a.default.createElement("div",null,a.default.createElement(l.Slider,{value:V.shadowOffsetX,onChange:e=>{j({shadowOffsetX:e})},min:-50,max:50,showTrackFill:!1,labelRenderer:!1})),a.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},a.default.createElement("div",null,(0,d.t)("toolbar.offsetY")),a.default.createElement("div",null,a.default.createElement(exports.NumberInput,{value:V.shadowOffsetY,onValueChange:e=>{j({shadowOffsetY:c(e,-50,50)})},style:{width:"50px"},min:-50,max:50,buttonPosition:"none"}))),a.default.createElement("div",null,a.default.createElement(l.Slider,{value:V.shadowOffsetY,onChange:e=>{j({shadowOffsetY:e})},min:-50,max:50,showTrackFill:!1,labelRenderer:!1})),a.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},a.default.createElement("div",null,(0,d.t)("toolbar.opacity")),a.default.createElement("div",null,a.default.createElement(exports.NumberInput,{value:Math.round(100*V.shadowOpacity),onValueChange:e=>{j({shadowOpacity:e/100})},style:{width:"50px"},min:0,max:100,buttonPosition:"none"}))),a.default.createElement("div",null,a.default.createElement(l.Slider,{value:100*V.shadowOpacity,onChange:e=>{j({shadowOpacity:e/100})},min:0,max:100,labelRenderer:!1})),a.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},a.default.createElement("div",{style:{lineHeight:"30px"}},(0,d.t)("toolbar.color")),a.default.createElement(i.default,{value:V.shadowColor,size:30,onChange:e=>{j({shadowColor:e})},store:e}))))}));