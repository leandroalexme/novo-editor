var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.LayersPanel=void 0;const t=e(require("react")),l=require("mobx-react-lite"),a=require("@blueprintjs/core"),n=require("../utils/l10n"),i=require("../utils/screen"),d=require("react-sortablejs"),r=require("../utils/text"),s=require("@blueprintjs/icons"),o=(0,l.observer)((({element:e,store:l})=>{const i=l.selectedElements.indexOf(e)>=0,[d,o]=t.default.useState(!1),c=()=>o(!1),u=d?e.name:e.name||(0,r.removeTags)(e.text)||`#${e.id}`;return t.default.createElement(a.Card,{onMouseDown:t=>{const a=t.ctrlKey||t.metaKey||t.shiftKey?[...l.selectedElementsIds]:[];a.indexOf(e.id)<0&&a.push(e.id),l.selectElements(a)},className:i?"selected":"",style:{padding:"5px",margin:"0px 1px 5px 1px",backgroundColor:i?"rgb(0, 161, 255, 0.2)":"",display:e.selectable||"admin"===l.role?"auto":"none"}},t.default.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},t.default.createElement("div",{style:{lineHeight:"30px",display:"flex"}},t.default.createElement("div",{className:"drag-handle",style:{display:"flex",justifyContent:"center",alignItems:"center",cursor:"move",height:"30px"}},t.default.createElement(s.DragHandleVertical,null)),t.default.createElement("div",{style:{padding:"0 7px",opacity:.5,width:"60px"}},(0,n.t)("sidePanel.layerTypes."+e.type)),t.default.createElement("div",{style:{maxWidth:"142px"}},t.default.createElement(a.EditableText,{minWidth:130,placeholder:(0,n.t)("sidePanel.namePlaceholder"),value:u,maxLines:1,onEdit:()=>o(!0),onCancel:c,onConfirm:c,onChange:t=>{e.set({name:t})}}))),t.default.createElement("div",null,t.default.createElement(a.Button,{minimal:!0,icon:(null==e?void 0:e.visible)?t.default.createElement(s.EyeOpen,null):t.default.createElement(s.EyeOff,null),onClick:()=>{e.set({visible:!e.visible})}}),t.default.createElement(a.Button,{minimal:!0,icon:(null==e?void 0:e.locked)?t.default.createElement(s.Lock,null):t.default.createElement(s.Unlock,null),onClick:()=>{e.set({draggable:e.locked,contentEditable:e.locked,styleEditable:e.locked,resizable:e.locked,removable:e.locked})}}),t.default.createElement(a.Button,{icon:t.default.createElement(s.Trash,null),minimal:!0,disabled:!e.removable,onClick:()=>{l.deleteElements([e.id])},style:{marginLeft:"auto"}}))))}));exports.LayersPanel=(0,l.observer)((({store:e})=>{var l;const a=(null===(l=e.activePage)||void 0===l?void 0:l.children.map((e=>({id:e.id}))))||[];a.reverse();const r=(0,i.isMobile)();return t.default.createElement("div",{style:{height:"100%",overflow:"auto"}},t.default.createElement("div",{style:{height:"40px",paddingTop:"5px"}},(0,n.t)("sidePanel.layersTip")),t.default.createElement("div",null,0===a.length?t.default.createElement("div",null,(0,n.t)("sidePanel.noLayers")):null,t.default.createElement(d.ReactSortable,{list:a,setList:t=>{t.forEach((({id:l},a)=>{var n,i;const d=t.length-a-1,r=e.getElementById(l);(null===(n=e.activePage)||void 0===n?void 0:n.children.indexOf(r))!==d&&(null===(i=e.activePage)||void 0===i||i.setElementZIndex(r.id,d))}))},direction:"horizontal",handle:r?".drag-handle":void 0},a.map((({id:l})=>{const a=e.getElementById(l);return t.default.createElement(o,{element:a,store:e,key:l})})))))}));