var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.useInfiniteAPI=exports.fetcher=void 0;const t=require("react"),r=e(require("swr/infinite"));exports.fetcher=e=>fetch(e).then((e=>e.json())),exports.useInfiniteAPI=({defaultQuery:e="",timeout:i=1e3,getAPI:o,getSize:u=e=>e.total_pages,fetchFunc:n=exports.fetcher})=>{var l;const s=(0,t.useRef)(e),a=(0,t.useRef)(),{data:d,error:c,size:f,setSize:v,mutate:h}=(0,r.default)((e=>o({query:s.current,page:e+1})),n,{revalidateAll:!1,revalidateOnFocus:!1}),p=!d&&!c||f>0&&d&&void 0===d[f-1],g=0===(null===(l=null==d?void 0:d[0])||void 0===l?void 0:l.length),_=null==d?void 0:d[d.length-1],m=g||_&&u(_)===f;return{setQuery:(0,t.useCallback)((e=>{s.current=e,clearTimeout(a.current),a.current=setTimeout((()=>{h([])}),i)}),[i,h]),isLoading:p,loadMore:()=>{m||v(f+1)},isReachingEnd:m,data:null==d?void 0:d.filter(Boolean),items:(null==d?void 0:d.flat())||[],hasMore:!m,reset:h,error:c}};