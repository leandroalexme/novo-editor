Object.defineProperty(exports,"__esModule",{value:!0}),exports.registerAnimation=exports.animate=exports.animations=void 0;const t=require("./math"),o={right:{from:{x:-200},to:{x:0}},left:{from:{x:200},to:{x:0}},up:{from:{y:200},to:{y:0}},down:{from:{y:-200},to:{y:0}},"bottom-right":{from:{x:-200,y:-200},to:{x:0,y:0}},"bottom-left":{from:{x:200,y:-200},to:{x:0,y:0}},"top-right":{from:{x:-200,y:200},to:{x:0,y:0}},"top-left":{from:{x:200,y:200},to:{x:0,y:0}}},i={right:{cropX:-1},left:{cropX:1},up:{cropY:1},down:{cropY:-1}};exports.animations={fade:({dTime:t,element:o,animation:i})=>{const e=t/i.duration;return"enter"===i.type?{opacity:e*o.opacity}:{opacity:(1-e)*o.opacity}},rotate:({dTime:o,element:i,animation:e})=>{const n=o/e.duration*360;return(0,t.rotateAroundCenter)({x:i.x,y:i.y,width:i.width,height:i.height,rotation:i.rotation},n)},blink:({dTime:t,element:o,animation:i})=>{const e=i.duration,n=t%e/(e/2),r=n<=1?n:2-n;return{opacity:o.opacity*r}},bounce:({dTime:t,element:o,animation:i})=>{var e;const n=i.duration,r=n/2,a=null!==(e=i.data.strength)&&void 0!==e?e:1,h={},m={x:o.x+o.width/3*a,y:o.y+o.height/3*a,width:o.width/3*a,height:o.height/3*a,fontSize:o.fontSize/3*a},d={x:o.x,y:o.y,width:o.width,height:o.height,fontSize:o.fontSize},c=t%n/r,p=c<=1?c:2-c;for(let s in m){const t=m[s],o=d[s]-t;h[s]=t+p*o}return h},move:({dTime:t,element:i,animation:e})=>{var n;const r=o[e.data.direction]||o.right,a=null!==(n=e.data.strength)&&void 0!==n?n:1,h={};for(var m in r.from){let o=r.from[m],n=r.to[m];"exit"===e.type&&(o=r.to[m],n=-r.from[m]),o*=a,n*=a;const d=i[m]+o,c=i[m]+n-d;h[m]=d+t/e.duration*c}return h},zoom:({dTime:t,element:o,animation:i})=>{var e;const n={},r=1+(("in"===(i.data.direction||"in")?3/4:5/4)-1)*(null!==(e=i.data.strength)&&void 0!==e?e:1),a=o.rotation*Math.PI/180,h=Math.cos(a),m=Math.sin(a),d=o.width*(1-r),c=o.height*(1-r),p=(d*h-c*m)/2,s=(d*m+c*h)/2,x={x:o.x+p,y:o.y+s,width:o.width*r,height:o.height*r,fontSize:o.fontSize*r},l={x:o.x,y:o.y,width:o.width,height:o.height,fontSize:o.fontSize};for(var y in x){let o=x[y],e=l[y];if("exit"===i.type){const t=o;o=e,e=t}const r=e-o;n[y]=o+t/i.duration*r}return n},cameraZoom:({dTime:t,element:o,animation:e})=>{var n,r,a;const h={},m=e.data.direction||"right",d=i[m]||i.right,c=null!==(n=e.data.movementStrength)&&void 0!==n?n:.1,p=null!==(r=e.data.shakeStrength)&&void 0!==r?r:.015;let s=null!==(a=e.data.zoomStrength)&&void 0!==a?a:.6;const x=t/e.duration,l=p*(1-x),y=Math.sin(12*x)*l*.7+Math.sin(8*x)*l*.3;if("exit"===e.type){const t=Math.max(o.cropWidth||1,o.cropHeight||1);s=Math.min(s,1-t)}e.type;const f=1-Math.pow(1-x,2),g=o.cropX||0,u=o.cropY||0,v=o.cropWidth||1,w=o.cropHeight||1,M=v,S=w;let z,T,X=0,Y=0;if(d.cropX){const t=d.cropX>0?1-(g+v):g;X=Math.min(t,Math.abs(c))*d.cropX}if(d.cropY){const t=d.cropY>0?1-(u+w):u;Y=Math.min(t,Math.abs(c))*d.cropY}return"enter"===e.type?(z=d.cropX?g+X*(1-f):g,T=d.cropY?u+Y*(1-f):u):(z=d.cropX?g+X*f:g,T=d.cropY?u+Y*f:u),h.cropX=Math.max(0,Math.min(1-M,z+y*M)),h.cropY=Math.max(0,Math.min(1-S,T+y*S)),h.cropWidth=M,h.cropHeight=S,h}},exports.animate=({element:t,dTime:o,animation:i})=>{const e=exports.animations[i.name];return e?e({element:t,dTime:o,animation:i}):(console.error("Can not find animation type: "+i.name),{})},exports.registerAnimation=(t,o)=>{exports.animations[t]&&console.warn(`Animation "${t}" already exists and will be overridden`),exports.animations[t]=o};