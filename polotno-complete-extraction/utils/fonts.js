var t,e=this&&this.__createBinding||(Object.create?function(t,e,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(e,o);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(t,n,r)}:function(t,e,o,n){void 0===n&&(n=o),t[n]=e[o]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=this&&this.__importStar||(t=function(e){return t=Object.getOwnPropertyNames||function(t){var e=[];for(var o in t){Object.prototype.hasOwnProperty.call(t,o)&&(e[e.length]=o)}return e},t(e)},function(n){if(n&&n.__esModule){return n}var r={};if(null!=n){for(var l=t(n),i=0;i<l.length;i++){"default"!==l[i]&&e(r,n,l[i])}}return o(r,n),r});Object.defineProperty(exports,"__esModule",{value:!0}),exports.isFontLoaded=exports.globalFonts=void 0,exports.isGoogleFontChanged=function(){return a.value},exports.setGoogleFonts=function(t){"default"!==t?(a.value=!0,i.splice(0,i.length),i.push(...t)):a.value=!1},exports.getFontsList=function(){return i},exports.addGlobalFont=function(t){exports.globalFonts.push(t)},exports.removeGlobalFont=function(t){const e=exports.globalFonts.findIndex((e=>e.fontFamily===t));-1!==e&&exports.globalFonts.splice(e,1)},exports.replaceGlobalFonts=function(t){exports.globalFonts.replace(t)},exports.loadFont=async function(t,e,o){var n;if(f[t]){return}const r=!!(null===(n=document.fonts)||void 0===n?void 0:n.load),i=u("Arial","Arial",e,o);if(r){try{await document.fonts.load(`16px '${t}', ${e} ${o}`);if(i!==u(t,"Arial",e,o)){return void(f[t]=!0)}}catch(d){}}const a=u("Times","Times",e,o),s=u(t,"Arial",e,o),c=Math.min(6e3,(0,l.getFontLoadTimeout)())/60;for(let l=0;l<c;l++){const n=u(t,"Arial",e,o),r=u(t,"Times",e,o);if(n!==s||n!==i||r!==a){return void(f[t]=!0)}await new Promise((t=>setTimeout(t,60)))}console.warn(`Timeout for loading font "${t}". Looks like polotno can't load it. Is it a correct font family?`),(0,l.triggerLoadError)(`Timeout for loading font "${t}"`)},exports.setGoogleFontsVariants=function(t){p=t},exports.getGoogleFontsVariants=function(){return p},exports.getGoogleFontsUrl=m,exports.injectGoogleFont=function(t){if(d[t]){return}const e=m(t),o=document.createElement("link");o.type="text/css",o.href=e,o.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(o),d[t]=!0},exports.injectCustomFont=function(t){const e=t.fontFamily;if(g[e]){return}if(!t.url&&!t.styles){return}const o=t.styles||(t.url?[{src:`url("${t.url}")`}]:[]);let n="";o.forEach((t=>{n+=`\n      @font-face {\n        font-family: '${e}';\n        src: ${t.src};\n        font-style: ${t.fontStyle||"normal"};\n        font-weight: ${t.fontWeight||"normal"};\n      }\n    `}));x().innerHTML+=n,g[t.fontFamily]=!0};const r=n(require("mobx")),l=require("./loader");let i=r.observable(["Roboto","Amatic SC","Press Start 2P","Marck Script","Rubik Mono One"]),a=r.observable({value:!1});exports.globalFonts=r.observable([]);var s="Some test text;?#D-ПРИВЕТ!1230o9u8i7y6t5r4e3w2q1",c=document.createElement("canvas");function u(t,e="Arial",o="normal",n="normal"){var r=c.getContext("2d");return r.font=`${o} ${n} 40px '${t}', ${e}`,r.measureText(s).width}const f={Arial:!0};exports.isFontLoaded=t=>!!f[t];const d={};let p="400,400italic,700,700italic";function m(t){return`https://fonts.googleapis.com/css?family=${t.replace(/ /g,"+")}:${p}`}const g={};let b;function x(){return b||(b=document.getElementById("polotno-font-style"),b||(b=document.createElement("style"),b.id="polotno-font-style",document.head.appendChild(b)),b)}