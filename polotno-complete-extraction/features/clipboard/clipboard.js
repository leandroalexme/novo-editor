Object.defineProperty(exports,"__esModule",{value:!0}),exports.isClipboardEmpty=exports.paste=exports.cut=exports.copy=void 0;const e=require("../model/group-model"),t=require("./math");let a={data:[],pageId:""};const o="polotno_clipboard",l=(e,t)=>{a={data:JSON.parse(JSON.stringify(e)),pageId:t};try{localStorage.setItem(o,JSON.stringify(e)),localStorage.setItem(o+"_page",t)}catch(l){}},i=()=>{try{const e=localStorage.getItem(o),t=localStorage.getItem(o+"_page");if(e){return{data:JSON.parse(e),pageId:t}}}catch(e){}return a};exports.copy=e=>{var t;0!==e.selectedElements.length&&l(e.selectedElements.map((e=>e.toJSON())),null===(t=e.activePage)||void 0===t?void 0:t.id)},exports.cut=e=>{var t;l(e.selectedElements.map((e=>e.toJSON())),null===(t=e.activePage)||void 0===t?void 0:t.id);let a=e.selectedElements.filter((e=>e.removable)).map((e=>e.id));e.deleteElements(a)},exports.paste=a=>{a.history.transaction((()=>{var o,r;let d=0,s=0;const{data:p,pageId:c}=i();if(c===(null===(o=a.activePage)||void 0===o?void 0:o.id)){d=a.width/20,s=a.height/20}else{const o=[];(0,e.forEveryChild)({children:p},(e=>{"group"!==e.type&&o.push(e)}));const l=(0,t.getTotalClientRect)(o);l.maxX>a.width&&(d=-l.minX),l.maxY>a.height&&(s=-l.minY)}const n=[];(0,e.forEveryChild)({children:p},(e=>{delete e.id,"group"!==e.type&&(e.x+=d,e.y+=s)})),p.forEach((e=>{var t;const o=null===(t=a.activePage)||void 0===t?void 0:t.addElement(e);o&&n.push(o.id)})),l(p,null===(r=a.activePage)||void 0===r?void 0:r.id),a.selectElements(n)}))},exports.isClipboardEmpty=()=>0===i().data.length;